<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>tinselR - an RShiny app for phylogenetic tree annotation • tinselR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="tinselR - an RShiny app for phylogenetic tree annotation">
<meta property="og:description" content="tinselR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tinselR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">Installation</a>
</li>
<li>
  <a href="../articles/index.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jennahamlin/tinselR">
    <span class=" www/favicon.ico"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="tinselR_files/jquery-1.11.3/jquery.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1">
<link href="tinselR_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet">
<script src="tinselR_files/bootstrap-3.3.5/js/bootstrap.min.js"></script><script src="tinselR_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script><script src="tinselR_files/bootstrap-3.3.5/shim/respond.min.js"></script><script src="tinselR_files/jqueryui-1.11.4/jquery-ui.min.js"></script><link href="tinselR_files/tocify-1.9.1/jquery.tocify.css" rel="stylesheet">
<script src="tinselR_files/tocify-1.9.1/jquery.tocify.js"></script><script src="tinselR_files/navigation-1.1/tabsets.js"></script><script src="tinselR_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>tinselR - an RShiny app for phylogenetic tree annotation</h1>
                        <h4 class="author">Contributors</h4>
                        <h4 class="author">Jenna Hamlin</h4>
                        <h4 class="author">Teo Nakov</h4>
                        <h4 class="author">Jo Williams-Newkirk</h4>
            
            <h4 class="date">2021-02-10</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jennahamlin/tinselR/blob/master/vignettes/tinselR.Rmd"><code>vignettes/tinselR.Rmd</code></a></small>
      <div class="hidden name"><code>tinselR.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jennahamlin/tinselR">tinselR</a></span><span class="op">)</span></code></pre></div>
<div id="why-tinselr" class="section level3">
<h3 class="hasAnchor">
<a href="#why-tinselr" class="anchor"></a><span class="header-section-number">0.0.1</span> Why tinselR</h3>
<p>Across the United States, public health laboratories perform whole-genome
sequencing for many pathogens, a milestone for protecting public health by
subtyping organisms at a higher resolution than was previously possible. These
high resolution subtypes can be used to determine the relationships between
organisms, which can be visualized with phylogenetic trees. Once the
phylogenetic relationships of pathogens are known, empirically derived
thresholds can be used to identify possible outbreaks, and additional
epidemiological data can be added to the visualization. In combination, these
data can be used to inform the design of investigations, to confirm the
occurrence of an outbreak, and identify potential transmission routes. If
appropriate, interventions such as the recall of contaminated products and
public announcements may be issued. Thus, creation and markup of phylogenetic
trees is an essential component for this public health workflow. Our goal was to
develop an open-source graphical user interface (GUI) for phylogenetic tree
visualization and annotation usable by persons without specialized
bioinformatics or data visualization skills. Given that the R programming
language contains some of the gold standard packages for phylogenetic analyses
and visualization (e.g. ape, and ggtree), we used the Rshiny framework to
develop tinselR (pronounced tinsel-er) to provide GUI access to the tools in
ape, ggtree, and other key packages. tinselR’s minimum input requirement is a
Newick formatted phylogenetic tree. Once loaded, user-selected inputs change the
appearance of the displayed tree. For example, a user can quickly transform tip
label formatting. By adding a genetic distance matrix or metadata file or both,
the user can include annotations on the image, relabel tips, or add a heatmap to
the phylogenetic tree. These modified tree images are downloadable in various
formats (pdf, png, or tiff) for presentations, publications, or other
communications with collaborators. Below we will detail and outline how to use
the application, using one of the example datasets.</p>
</div>
<div id="getting-started" class="section level3">
<h3 class="hasAnchor">
<a href="#getting-started" class="anchor"></a><span class="header-section-number">0.0.2</span> Getting started</h3>
<div id="testing-with-example-data" class="section level4">
<h4 class="hasAnchor">
<a href="#testing-with-example-data" class="anchor"></a><span class="header-section-number">0.0.2.1</span> <em>Testing with example data</em>
</h4>
<div id="example-data" class="section level5">
<h5 class="hasAnchor">
<a href="#example-data" class="anchor"></a><span class="header-section-number">0.0.2.1.1</span> Example data</h5>
<p>When the application is launched, the user can test out the application by
using one of the pre-loaded datasets located in the ‘Example Data’ tab (Figure
<a href="#fig:exampleDataPane1">1</a>). We provide three datasets (i.e. Newick-formatted
tree, genetic distance matrix, and metadata file) already combined with the
number of isolates ranging from 14 - 19. These data are either <em>Eschericia coli</em>
(NCBI Bioproject: PRJNA218110) or <em>Salmonella enterica</em> (NCBI Bioproject:
PRJNA230403). After clicking on the ‘Example Data’ tab
(Figure <a href="#fig:exampleDataPane1">1</a>), the user selects from the drop down menu
one of the combined datasets (e.g. example data 1, example data 2, and
example data 3; - see Figure <a href="#fig:exampleDataPane2">2</a>).</p>
<div class="figure">
<span id="fig:exampleDataPane1"></span>
<img src="Slide1.PNG" alt="Landing page for tinselR with 'Example Data' tab highlighted in blue." width="100%"><p class="caption">
Figure 1: Landing page for tinselR with ‘Example Data’ tab highlighted in blue.
</p>
</div>
<br><br><div class="figure">
<span id="fig:exampleDataPane2"></span>
<img src="Slide2.PNG" alt="Pre-loaded example dataset 1 is selected and can be seen once the user presses the 'Visaulize Tree' button." width="100%"><p class="caption">
Figure 2: Pre-loaded example dataset 1 is selected and can be seen once the user presses the ‘Visaulize Tree’ button.
</p>
</div>
<p><br><br><strong>Displaying example tree and genetic distance data</strong></p>
Once you have selected one of the datasets, to begin using the application,
press the ‘Visualize Tree’ button. At this point all potential tree visual
parameters you want to alter are available using drop down menus
(e.g. annotation label color), user input (e.g. size of scale bar), or
users selection (e.g. midpoint root). All tree visual parameters that a user
can adjust are displayed in Figure <a href="#fig:exampleDataPane3">3</a>. In Figure <a href="#fig:exampleDataPane4">4</a>, part of a phylogenetic tree is displayed with the
tips right aligned after checking the box available in the alter tree visual
parameters.
<br><br><div class="figure">
<span id="fig:exampleDataPane3"></span>
<img src="Slide3.PNG" alt="'Example Data' tab with available tree visual parameters highlighted within the blue box." width="100%"><p class="caption">
Figure 3: ‘Example Data’ tab with available tree visual parameters highlighted within the blue box.
</p>
</div>
<br><br><div class="figure">
<span id="fig:exampleDataPane4"></span>
<img src="Slide4.PNG" alt="Pressing 'Visualize Tree' button will allow the tree to be viewed on screen. Within the larger blue box, part of a phylogenetic tree is displayed with tips right aligned. The smaller blue box indicates that the 'align the tips' box has been selected." width="100%"><p class="caption">
Figure 4: Pressing ‘Visualize Tree’ button will allow the tree to be viewed on screen. Within the larger blue box, part of a phylogenetic tree is displayed with tips right aligned. The smaller blue box indicates that the ‘align the tips’ box has been selected.
</p>
</div>
<br><br>
With the genetic distance file uploaded, a user can highlight clades to
add annotations, which will display the range and median of single Nucleotide
polymorphismss (SNPs) for tips that are included in the highlighted selection (Figure <a href="#fig:exampleDataPane5">5</a>). To ensure the correct display of the annotation, the user should highlight the tips of interest and include within the highlighted section their most recent common ancestor, (Figure <a href="#fig:exampleDataPane5">5</a>). In theory, one can add as many annotations as you want, though at some point the annotations may run off the plot area and thus you may need to add more space to plot (Tree visual parameter - ‘Add Spacing to Plot’). The ability to change spacing to the plot is one of the tree visual parameters that can be adjusted (Figure <a href="#fig:exampleDataPane3">3</a>). We would also recommend to only include those that help describe the outbreak clades of interest. Any annotation placed on the plot can be removed by pushing the ‘Remove Annotations’ button (Figure <a href="#fig:exampleDataPane5">5</a>). Unlike with the ‘Add Annotation’ button, you do not need to highlight which annotation you would like to remove. Essentially this removes annotations by removing the last placed annotation until there are no more.
<br><br><div class="figure">
<span id="fig:exampleDataPane5"></span>
<img src="Slide5.PNG" alt="With tips of interest highlighted, pressing the 'Add Annotations' button will add annotations to the tree image, which indicate the range and median of SNPs for these tips of interest. The tree with annotations is within the larger blue box, while the buttons for adding/removing annotations are in the smaller box on the left of image. " width="100%"><p class="caption">
Figure 5: With tips of interest highlighted, pressing the ‘Add Annotations’ button will add annotations to the tree image, which indicate the range and median of SNPs for these tips of interest. The tree with annotations is within the larger blue box, while the buttons for adding/removing annotations are in the smaller box on the left of image.
</p>
</div>
<p><br><br><strong>Included example metadata for tip correction and heatmap</strong></p>
Figure <a href="#fig:exampleDataPane6">6</a> provides an example metadata file with
three columns: 1) ‘Tip.labels’; those tip labels within in the Newick-formatted
tree, 2) ‘Display.labels’; what you would like the tip labels in the tree to be
changed to, and 3) an optional column label whatever that column reflects. Here, the third column is called ‘SourceSite’ indicating the collection site of the isolates. When the metadata is included and a user pushes the ‘Visualize Tree’ button, automatic tip correction occurs, meaning that the tips within the Newick-formatted tree convert to what you the user decided (e.g.
‘Display.labels’ column in metadata file). The ability to add a <a href="https://yulab-smu.top/treedata-book/chapter7.html">heatmap</a>,
allows the user to include either categorical or numerical data for their tree
image either with or without annotations
(Figure <a href="#fig:exampleDataPane7">7</a>).
<br><br><div class="figure" style="text-align: center">
<span id="fig:exampleDataPane6"></span>
<img src="Slide6.PNG" alt="Example metadata 1 with the third column included with information used for adding a heatmap. " width="75%"><p class="caption">
Figure 6: Example metadata 1 with the third column included with information used for adding a heatmap.
</p>
</div>
<br><br><div class="figure">
<span id="fig:exampleDataPane7"></span>
<img src="Slide7.PNG" alt="Tree image with annotations and a heatmap of collection source displayed within blue box. The add heatmap is also within the blue box on the left of the image." width="100%"><p class="caption">
Figure 7: Tree image with annotations and a heatmap of collection source displayed within blue box. The add heatmap is also within the blue box on the left of the image.
</p>
</div>
<p><br><br><strong>Downloading your image</strong></p>
<p>Once you are happy with the way your tree looks, you can download the image
in either pdf, png, or tiff formats (Figure <a href="#fig:exampleDataPane8">8</a>). Make
sure you adjust the height and width of the image that you download. Note that
once the image has downloaded, if you want to re-download with anything changed, just adjust as you wish and push the ‘Download’ button again.</p>
<div class="figure">
<span id="fig:exampleDataPane8"></span>
<img src="Slide8.PNG" alt="Tree image with annotations and a heatmap of collection source displayed. The download image options is within the blue box on the bottom of the image." width="100%"><p class="caption">
Figure 8: Tree image with annotations and a heatmap of collection source displayed. The download image options is within the blue box on the bottom of the image.
</p>
</div>
<p><br><br></p>
</div>
</div>
<div id="using-your-data" class="section level4">
<h4 class="hasAnchor">
<a href="#using-your-data" class="anchor"></a><span class="header-section-number">0.0.2.2</span> Using your data</h4>
<div id="differences-between-example-data-tab-and-upload-data" class="section level5">
<h5 class="hasAnchor">
<a href="#differences-between-example-data-tab-and-upload-data" class="anchor"></a><span class="header-section-number">0.0.2.2.1</span> Differences between example data tab and upload data</h5>
There are only two differences between the ‘Example Data’ and the ‘Data Upload’
tabs: the example data tab has pre-loaded data, while the data
upload tab is where you, the user, can upload your own files (i.e. tree,
genetic distance, and metadata). By that we mean, in the ‘Example Data’ tab,
the user only has three options to select from - example data 1, example data 2, and example data 3 - displayed in one drop down menu. While in the ‘Data Upload’ tab, there are three drop down menus - 1) tree upload, 2) genetic upload, and 3)meta upload (Figure <a href="#fig:userDataPane1">9</a>). The only required file is the Newick-formatted tree, the other two files are optional.
<br><br><div class="figure">
<span id="fig:userDataPane1"></span>
<img src="Slide9.PNG" alt="'Data Upoad' tab for user's own data upload The larger blue box contains the three dropdown menus for the three different files a user can upload. The smaller blue boxes indicates the 'Data Upload' tab." width="100%"><p class="caption">
Figure 9: ‘Data Upoad’ tab for user’s own data upload The larger blue box contains the three dropdown menus for the three different files a user can upload. The smaller blue boxes indicates the ‘Data Upload’ tab.
</p>
</div>
<p><br><br>
Second, given problems that can occur during user upload, we provide file upload error messages in hopes of helping, you the user, with checking that all three files are concordant in terms of tip label information. As these concordant tip labels are the main mechanism of connecting the three files. If there is variation in the three files, a message will be displayed to the user regarding how the file tip labels differ. File checking happens independently of if the user wants the information. By that we mean, a user can ignore the file check messages if they do not need them and proceed using the application. Please note that this concordant tip checking will only display a complete message if all three files are uploaded (tree, genetic, and meta). Beyond these two things, the application is exactly the same between the example data tab and the upload data tab, thus this is why we highly encourage users to play with the example data first to familiarize yourself with the application.</p>
</div>
<div id="file-types-and-format-for-uploaded-data" class="section level5">
<h5 class="hasAnchor">
<a href="#file-types-and-format-for-uploaded-data" class="anchor"></a><span class="header-section-number">0.0.2.2.2</span> File types and format for uploaded data</h5>
The application relies on treeio’s function read.newick (<code><a href="https://docs.ropensci.org/treeio/reference/read.newick.html">treeio::read.newick</a></code>),to read in a Newick-formatted tree. treeio is associated with the package ggtree, which extends the ggplot2 plotting system to phylogenetic trees. In theory, any application that can produce a Newick-formatted tree should be able to be uploaded. The tip labels in the Newick tree, distance matrix, and metadata files must match before upload. The genetic distance matrix file must contain a square matrix of single nucleotide polymorphism (SNP) differences between the tree tips (Figure <a href="#fig:userData2">10</a>). The metadata file is a table of additional information to be changed or displayed on the tree. The primary function of the metadata file is to relabel the tips on the tree image. The header of the first column must be Tip.labels, and it must contain the labels for all tree tips in the uploaded Newick file (Figure <a href="#fig:exampleDataPane6">6</a>). The alternative identification labels can be provided in the metadata file using the column header Display.labels in column two. If desired, users may include additional columns in the metadata file, such as the collection site (Figure <a href="#fig:exampleDataPane6">6</a>), and display the information in a heatmap next to the tree. Headers for these other columns in the metadata file are flexible because they are not automatically recognized and used by tinselR. Acceptable formats include CSV, TSV, and TXT for the genetic distance and metadata files. Users can set file types independently for each input.
<br><br><div class="figure" style="text-align: center">
<span id="fig:userData2"></span>
<img src="Slide10.PNG" alt="Genetic distance matrix example with tip labels that match the Newick phylogeneti tree." width="75%"><p class="caption">
Figure 10: Genetic distance matrix example with tip labels that match the Newick phylogeneti tree.
</p>
</div>
<p><br><br></p>
</div>
<div id="caveats" class="section level5">
<h5 class="hasAnchor">
<a href="#caveats" class="anchor"></a><span class="header-section-number">0.0.2.2.3</span> Caveats</h5>
<p>Note, we have only tested the application using trees with ~ 30
tips with success, beyond that tip number we are interested to see how the application does, so please do let us know.</p>
<p>Another caveat is that if the user does this specific sequence of steps,
the tree image will be wiped and not include clade annotations already drawn
on the tree. However, we expect this sequence of events to rarely happen.</p>
<p><strong>Order of events - </strong></p>
<ul>
<li>upload phylogenetic tree</li>
<li>upload genetic distance matrix</li>
<li>annotate tree</li>
<li>upload metadata - after this file is uploaded all annotations drawn on the
tree will be removed.</li>
</ul>
</div>
</div>
</div>
<div id="getting-help" class="section level3">
<h3 class="hasAnchor">
<a href="#getting-help" class="anchor"></a><span class="header-section-number">0.0.3</span> Getting Help</h3>
<p>If you have problems, requests, or thoughts, please file an
<a href="https://github.com/jennahamlin/tinselR/issues">issue</a>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Jenna Hamlin.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
